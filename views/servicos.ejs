<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <script>
      const listaServico = [
      <% listaServico.forEach(item => { %>
        {
          id: <%= item.id %>,
          desc: "<%= item.desc %>",
          preco: "<%= item.preco %>"
        },
      <% }); %>
      ];

      function testarDados() {
        const id = document.forms[0].id.value;

        const existe = listaServico.some(item => {
          console.log(`typeof: ${typeof item.id} value: ${item.id}`);
          console.log(`typeof: ${typeof Number(id)} value: ${Number(id)}`);
          const ret = (item.id === Number(id));
          return ret;
        });

        if (existe) {
          alert('Esse ID já foi utilizado');
          return false;
        }

        return true;
      }
    </script>
  </head>
  <body>
    <h1></h1>
    <ul>
      <% listaServico.forEach(item => { %>
      <li><%= item.id %>: <%= item.desc %> = <%= item.preco %></li>
      <% }); %>
    </ul>

    <hr />

    <form method="POST">
      Id: <input type="text" name="id" /><br />
      Descrição: <input type="text" name="desc" /><br />
      Preço: <input type="text" name="preco" /><br />
      <input type="hidden" name="rnd" value="<%= rnd %>" />
      <input type="submit" onClick="return testarDados()" />
    </form>

    <hr />

    <form method="POST" action="/servicos/importar" enctype="multipart/form-data">
      Arquivo: <input type="file" name="cnh" />
      <input type="hidden" name="rnd" value="<%= rnd %>" />
      <input type="submit" />
    </form>
  </body>
</html>
